@model Shinogi.ViewModels.ChallengeEditViewModel
@{
    var functions = new[] { ("linear", "Linear"), ("log", "Log"), ("exp", "Exp") };
    var logics = new[] { ("any", "Any"), ("all", "All"), ("teamconsensus", "Team Consensus") };
}
<section>
    <h1>Edit Challenge</h1>
    <form method="post" asp-action="UpdateChallenge" asp-route-id="@Model.Id" class="form form-wide">
        <label>Name<input name="Name" value="@Model.Name" required /></label>
        <label>Category
            <select name="Category" required>
                <option value="">-- ÈÅ∏Êäû --</option>
                @foreach (var cat in Model.Categories)
                {
                    if (cat == Model.Category)
                    {
                        <option value="@cat" selected>@cat</option>
                    }
                    else
                    {
                        <option value="@cat">@cat</option>
                    }
                }
            </select>
        </label>
        <label>Difficulty
            <select name="Difficulty">
                <option value="">-- ÈÅ∏Êäû --</option>
                @foreach (var diff in Model.Difficulties)
                {
                    if (diff == Model.Difficulty)
                    {
                        <option value="@diff" selected>@diff</option>
                    }
                    else
                    {
                        <option value="@diff">@diff</option>
                    }
                }
            </select>
        </label>
        <label>Description<textarea name="Description" rows="3">@Model.Description</textarea></label>
        <label>Value Initial<input name="ValueInitial" type="number" value="@Model.ValueInitial" /></label>
        <label>Value Minimum<input name="ValueMinimum" type="number" value="@Model.ValueMinimum" /></label>
        <label>Decay<input name="Decay" type="number" value="@Model.Decay" /></label>
        <label>Function
            <select name="Function">
                @foreach (var (val, label) in functions)
                {
                    if (val.Equals(Model.Function, StringComparison.OrdinalIgnoreCase))
                    {
                        <option value="@val" selected>@label</option>
                    }
                    else
                    {
                        <option value="@val">@label</option>
                    }
                }
            </select>
        </label>
        <label>Logic
            <select name="Logic">
                @foreach (var (val, label) in logics)
                {
                    if (val.Equals(Model.Logic, StringComparison.OrdinalIgnoreCase))
                    {
                        <option value="@val" selected>@label</option>
                    }
                    else
                    {
                        <option value="@val">@label</option>
                    }
                }
            </select>
        </label>
        <label>Max Attempts (optional)
            <input name="MaxAttempts" type="number" value="@(Model.MaxAttempts.HasValue ? Model.MaxAttempts.Value.ToString() : "")" />
        </label>
        <label>Âá∫È°åÊôÇÂàª (Á©∫Ê¨Ñ„ÅßÂç≥ÊôÇÂÖ¨Èñã)
            <input type="datetime-local" name="ReleaseAt" value="@Model.ReleaseAt" />
        </label>
        <div style="display:flex; align-items:center; gap:10px;">
            <label class="toggle-switch" title="@(Model.Published ? "ÂÖ¨Èñã‰∏≠" : "ÈùûÂÖ¨Èñã")">
                <input name="Published" type="checkbox" value="true" @(Model.Published ? "checked" : "") />
                <span class="toggle-slider"></span>
            </label>
            <span style="color:var(--primary-muted); font-size:14px;">Published</span>
        </div>

        <hr style="border:1px solid var(--primary-muted); margin:20px 0;" />
        <h3 style="color:var(--primary); margin-bottom:16px;">üê≥ „Ç§„É≥„Çπ„Çø„É≥„ÇπË®≠ÂÆö</h3>

        <div style="display:flex; align-items:center; gap:10px; margin-bottom:16px;">
            <label class="toggle-switch" title="@(Model.RequiresInstance ? "„Ç§„É≥„Çπ„Çø„É≥„ÇπÂøÖÈ†à" : "„Ç§„É≥„Çπ„Çø„É≥„Çπ‰∏çË¶Å")">
                <input name="RequiresInstance" type="checkbox" value="true" @(Model.RequiresInstance ? "checked" : "") />
                <span class="toggle-slider"></span>
            </label>
            <span style="color:var(--primary-muted); font-size:14px;">Requires Instance („Ç§„É≥„Çπ„Çø„É≥„ÇπËµ∑Âãï„ÅåÂøÖË¶Å)</span>
        </div>

        <label>Docker Image
            <input name="InstanceImage" value="@Model.InstanceImage" placeholder="‰æã: ctf-web-sqli:latest" />
            <small style="color:var(--primary-muted);">Docker„Ç§„É°„Éº„Ç∏ÂêçÔºà‰æã: ctf-web-sqli:latestÔºâ</small>
        </label>

        <label>Container Port (optional)
            <input name="InstancePort" type="number" value="@(Model.InstancePort.HasValue ? Model.InstancePort.Value.ToString() : "")" placeholder="80" />
            <small style="color:var(--primary-muted);">„Ç≥„É≥„ÉÜ„ÉäÂÜÖÈÉ®„Éù„Éº„ÉàÔºàÁ©∫Ê¨Ñ=80Ôºâ</small>
        </label>

        <label>Lifetime (ÂàÜ)
            <input name="InstanceLifetimeMinutes" type="number" value="@Model.InstanceLifetimeMinutes" required />
            <small style="color:var(--primary-muted);">„Ç§„É≥„Çπ„Çø„É≥„Çπ„ÅÆÊúâÂäπÊôÇÈñìÔºàÂàÜÔºâ</small>
        </label>

        <label>CPU Limit
            <input name="InstanceCpuLimit" value="@Model.InstanceCpuLimit" placeholder="0.5" required />
            <small style="color:var(--primary-muted);">CPUÂà∂ÈôêÔºà‰æã: 0.5 = 50%Ôºâ</small>
        </label>

        <label>Memory Limit
            <input name="InstanceMemoryLimit" value="@Model.InstanceMemoryLimit" placeholder="256m" required />
            <small style="color:var(--primary-muted);">„É°„É¢„É™Âà∂ÈôêÔºà‰æã: 256m, 1gÔºâ</small>
        </label>

        <button type="submit">Save</button>
    </form>
    <p style="margin-top:16px;"><a asp-action="Challenges">&larr; Back</a></p>
</section>
